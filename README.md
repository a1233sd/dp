# DiffPress ‚Äî —Å–µ—Ä–≤–∏—Å –¥–∏—Ñ—Ñ-–∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã—Ö –æ—Ç—á–µ—Ç–æ–≤

DiffPress ‚Äî —ç—Ç–æ –º–æ–¥—É–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∞–Ω—Ç–∏–ø–ª–∞–≥–∏–∞—Ç–∞, –∫–æ—Ç–æ—Ä–∞—è –∏–Ω–¥–µ–∫—Å–∏—Ä—É–µ—Ç –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã–µ –æ—Ç—á–µ—Ç—ã –≤ PDF –∏ –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ, –ø–æ—Ö–æ–∂–µ–º –Ω–∞ `git diff`. –°–µ—Ä–≤–∏—Å –ø–æ—Å—Ç—Ä–æ–µ–Ω –Ω–∞ Node.js/Next.js, —Ö—Ä–∞–Ω–∏—Ç —Ñ–∞–π–ª—ã –Ω–∞ –¥–∏—Å–∫–µ –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–æ–∫ –≤ SQLite, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—é —á–µ—Ä–µ–∑ Docker –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç REST API –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏.

---

## –ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üì• –ó–∞–≥—Ä—É–∑–∫–∞ –æ—Ç—á–µ—Ç–æ–≤ –≤ PDF —á–µ—Ä–µ–∑ REST API –∏–ª–∏ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- üîÑ –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–æ–≤–µ—Ä–æ–∫ –≤ –æ—á–µ—Ä–µ–¥—å –∏ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- üßÆ –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∫–æ—Å–∏–Ω—É—Å–Ω–æ–≥–æ —Å—Ö–æ–¥—Å—Ç–≤–∞
- üóÑÔ∏è –§–∞–π–ª—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –Ω–∞ —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –¥–∏—Å–∫–µ, –∞ –≤ –±–∞–∑–µ –ª–µ–∂–∞—Ç —Ç–æ–ª—å–∫–æ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∏ –ø—É—Ç–∏ –∫ —Ç–µ–∫—Å—Ç–æ–≤—ã–º –∏–Ω–¥–µ–∫—Å–∞–º
- üß© UI –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏ –≤–∏–∑—É–∞–ª—å–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –Ω–∞–π–¥–µ–Ω–Ω—ã–º–∏ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è–º–∏ (–∞–Ω–∞–ª–æ–≥ `git diff`)
- üìä –û—Ç—á–µ—Ç—ã –æ –ø—Ä–æ–≤–µ—Ä–∫–µ –¥–æ—Å—Ç—É–ø–Ω—ã –æ—Ç–¥–µ–ª—å–Ω—ã–º API –ø–æ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—É
- üê≥ –ì–æ—Ç–æ–≤—ã–π Dockerfile –∏ docker-compose –¥–ª—è —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è
- ‚ö° –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è —Å–æ–≤–ø–∞–≤—à–∏—Ö —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤: –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–ª–∞–≥–∏–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –ø–µ—Ä–≤—ã–º–∏ –≤ –±—É–¥—É—â–∏—Ö –∑–∞–ø—É—Å–∫–∞—Ö

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
.
‚îú‚îÄ‚îÄ Dockerfile                # –ú–Ω–æ–≥–æ—Å—Ç–∞–¥–∏–π–Ω–∞—è —Å–±–æ—Ä–∫–∞ Next.js
‚îú‚îÄ‚îÄ docker-compose.yml        # –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ —Å —Ç–æ–º–∞–º–∏ –¥–ª—è –ë–î –∏ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
‚îú‚îÄ‚îÄ data/                     # SQLite –±–∞–∑–∞ (—Å–æ–∑–¥–∞—ë—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api/              # REST API —Ä–æ—É—Ç—ã (Next.js App Router)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ components/       # UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (DiffViewer –∏ –¥—Ä.)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ layout.tsx        # –ë–∞–∑–æ–≤—ã–π layout –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ page.tsx          # –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å —Ñ–æ—Ä–º–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –∏ diff UI
‚îÇ   ‚îî‚îÄ‚îÄ lib/                  # –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã —Å –ë–î, —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º, –æ—á–µ—Ä–µ–¥—å—é –ø—Ä–æ–≤–µ—Ä–æ–∫
‚îÇ       ‚îú‚îÄ‚îÄ check-processor.ts    # –û—á–µ—Ä–µ–¥—å, —Ä–∞—Å—á—ë—Ç —Å—Ö–æ–¥—Å—Ç–≤–∞, –≥–µ–Ω–µ—Ä–∞—Ü–∏—è diff-preview
‚îÇ       ‚îú‚îÄ‚îÄ config.ts             # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—É—Ç–µ–π, –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
‚îÇ       ‚îú‚îÄ‚îÄ db.ts                 # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ SQLite —á–µ—Ä–µ–∑ better-sqlite3
‚îÇ       ‚îú‚îÄ‚îÄ repository.ts         # CRUD-–æ–ø–µ—Ä–∞—Ü–∏–∏ –Ω–∞–¥ –æ—Ç—á—ë—Ç–∞–º–∏ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏
‚îÇ       ‚îú‚îÄ‚îÄ storage.ts            # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ PDF –Ω–∞ –¥–∏—Å–∫
‚îÇ       ‚îî‚îÄ‚îÄ text.ts               # –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞ –∏ –∫–æ—Å–∏–Ω—É—Å–Ω–æ–µ —Å—Ö–æ–¥—Å—Ç–≤–æ
‚îî‚îÄ‚îÄ vitest.config.ts         # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç–µ—Å—Ç–æ–≤
```

---

## –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö

–°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –¥–≤—É–º—è –æ—Å–Ω–æ–≤–Ω—ã–º–∏ —Å—É—â–Ω–æ—Å—Ç—è–º–∏:

- **Report** ‚Äî –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–π –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã–π –æ—Ç—á—ë—Ç. –•—Ä–∞–Ω–∏—Ç –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ –∏–º—è —Ñ–∞–π–ª–∞, –∏–º—è —Ñ–∞–π–ª–∞ –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ, –ø—É—Ç—å –∫ —Ç–µ–∫—Å—Ç–æ–≤–æ–º—É –∏–Ω–¥–µ–∫—Å—É –∏ –¥–∞—Ç—É –∑–∞–≥—Ä—É–∑–∫–∏. –ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –æ—Ç—á—ë—Ç–∞ –æ–Ω —Å—Ä–∞–∑—É –ø–æ–ø–∞–¥–∞–µ—Ç –≤ –æ—á–µ—Ä–µ–¥—å –Ω–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å —Ä–∞–Ω–µ–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–º–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏. –ï—Å–ª–∏ –¥–ª—è –æ—Ç—á—ë—Ç–∞ –Ω–∞–π–¥–µ–Ω—ã —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è, —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç—Å—è —à—Ç–∞–º–ø –≤—Ä–µ–º–µ–Ω–∏ `priority_indexed_at`, –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–∏–æ—Ä–∏—Ç–µ–∑–∏—Ä—É–µ—Ç –±—É–¥—É—â–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏.
- **Check** ‚Äî —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—Ç—á—ë—Ç–∞. –°–æ–¥–µ—Ä–∂–∏—Ç —Å—Ç–∞—Ç—É—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è, –ø—Ä–æ—Ü–µ–Ω—Ç —Å—Ö–æ–∂–µ—Å—Ç–∏ —Å –ª—É—á—à–∏–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ–º, —Å–ø–∏—Å–æ–∫ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π –∏ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏. –ù–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–æ–≤–µ—Ä–æ–∫ –º–æ–≥—É—Ç –æ—Ç–Ω–æ—Å–∏—Ç—å—Å—è –∫ –æ–¥–Ω–æ–º—É –æ—Ç—á—ë—Ç—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ –∏–ª–∏ –ø–µ—Ä–µ—Å—á—ë—Ç–µ –º–µ—Ç—Ä–∏–∫).

–°–≤—è–∑—å –º–µ–∂–¥—É —Å—É—â–Ω–æ—Å—Ç—è–º–∏ ‚Äî ¬´–æ–¥–∏–Ω-–∫–æ-–º–Ω–æ–≥–∏–º¬ª: —É –æ–¥–Ω–æ–≥–æ –æ—Ç—á—ë—Ç–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–æ–≤–µ—Ä–æ–∫. –û—Å–Ω–æ–≤–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —á–µ—Ä–µ–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π `src/lib/repository.ts`, –∫–æ—Ç–æ—Ä—ã–π –∏–Ω–∫–∞–ø—Å—É–ª–∏—Ä—É–µ—Ç –≤—Å—Ç–∞–≤–∫—É, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏ –≤—ã–±–æ—Ä–∫—É –¥–∞–Ω–Ω—ã—Ö –∏–∑ SQLite.

---

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Node.js 20+
- npm 10+
- Docker 24+ (–¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞)

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–§–∞–π–ª –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —Ä–∞—Å–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤ `data/reports.sqlite` –∏ —Å–æ–∑–¥–∞—ë—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ. –°—Ö–µ–º–∞ –≤–∫–ª—é—á–∞–µ—Ç –¥–≤–µ —Ç–∞–±–ª–∏—Ü—ã:

```sql
CREATE TABLE IF NOT EXISTS reports (
  id TEXT PRIMARY KEY,
  original_name TEXT NOT NULL,
  stored_name TEXT NOT NULL,
  text_index TEXT NOT NULL,
  created_at TEXT NOT NULL,
  cloud_link TEXT,
  added_to_cloud INTEGER NOT NULL DEFAULT 0,
  priority_indexed_at TEXT
);

CREATE TABLE IF NOT EXISTS checks (
  id TEXT PRIMARY KEY,
  report_id TEXT NOT NULL,
  status TEXT NOT NULL,
  similarity REAL,
  matches TEXT,
  created_at TEXT NOT NULL,
  completed_at TEXT,
  FOREIGN KEY(report_id) REFERENCES reports(id)
);
```

- `reports` —Ö—Ä–∞–Ω–∏—Ç –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∏ –ø—É—Ç–∏ –∫ —Ç–µ–∫—Å—Ç–æ–≤—ã–º –∏–Ω–¥–µ–∫—Å–∞–º, —Ä–∞–∑–º–µ—â–µ–Ω–Ω—ã–º –≤–æ –≤–Ω–µ—à–Ω–µ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (–±–µ–∑ —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–∞–º–æ–≥–æ —Ç–µ–∫—Å—Ç–∞).
- `checks` —Å–æ–¥–µ—Ä–∂–∏—Ç –∏—Å—Ç–æ—Ä–∏—é –ø—Ä–æ–≤–µ—Ä–æ–∫: —Å—Ç–∞—Ç—É—Å (`queued`, `processing`, `completed`, `failed`), —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω–æ–µ —Å—Ö–æ–¥—Å—Ç–≤–æ –∏ —Å–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π JSON —Å–æ —Å–ø–∏—Å–∫–æ–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π.

–ü–æ—Å–ª–µ –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è –ø–ª–∞–≥–∏–∞—Ç–∞ —É –æ—Ç—á—ë—Ç–∞ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ–ª–µ `priority_indexed_at`, –∏ —Ç–∞–∫–∏–µ –∑–∞–ø–∏—Å–∏ –∞–Ω–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–∏—Ö –ø—Ä–æ–≤–µ—Ä–∫–∞—Ö.

–î–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–Ω–µ—à–Ω–∏–π –∫–ª—é—á `report_id`. –ñ—É—Ä–Ω–∞–ª–∏–∑–∞—Ü–∏—è –≤–∫–ª—é—á–µ–Ω–∞ –≤ —Ä–µ–∂–∏–º WAL, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω—ã–º–∏ —á—Ç–µ–Ω–∏—è–º–∏ –∏ —Ñ–æ–Ω–æ–≤–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—á–µ—Ä–µ–¥–∏.

---

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è              | –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------------------------|-----------------------|----------|
| `REPORT_STORAGE_DIR`    | `<–∫–æ—Ä–µ–Ω—å>/storage`    | –ü—É—Ç—å –∫ –∫–∞—Ç–∞–ª–æ–≥—É –Ω–∞ –¥–∏—Å–∫–µ, –∫—É–¥–∞ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è PDF. –î–∏—Å–∫ –¥–æ–ª–∂–µ–Ω —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å –∏ –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã–º –Ω–∞ –∑–∞–ø–∏—Å—å. |

–ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–æ–∑–¥–∞—Å—Ç:
- –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é `storage/` (–µ—Å–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –Ω–µ –∑–∞–¥–∞–Ω–∞ ‚Äî –≤–Ω—É—Ç—Ä–∏ –ø—Ä–æ–µ–∫—Ç–∞);
- –ø–æ–¥–∫–∞—Ç–∞–ª–æ–≥ `storage/text-indexes/` –¥–ª—è —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –∏–Ω–¥–µ–∫—Å–æ–≤ –æ—Ç—á—ë—Ç–æ–≤;
- —Ñ–∞–π–ª –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö `data/reports.sqlite`.

> üíæ **–í–∞–∂–Ω–æ:** –µ—Å–ª–∏ —É –≤–∞—Å —É–∂–µ –µ—Å—Ç—å –≤–Ω–µ—à–Ω–∏–π –¥–∏—Å–∫ —Å –∞—Ä—Ö–∏–≤–æ–º –æ—Ç—á—ë—Ç–æ–≤, —Å–º–æ–Ω—Ç–∏—Ä—É–π—Ç–µ –µ–≥–æ –∏ –ø–µ—Ä–µ–¥–∞–π—Ç–µ –ø—É—Ç—å —á–µ—Ä–µ–∑ `REPORT_STORAGE_DIR`. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–µ —Ñ–∞–π–ª—ã –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–º –∫–∞—Ç–∞–ª–æ–≥–µ, –Ω–µ —É–¥–∞–ª—è—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ.

---

## –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ –±–µ–∑ Docker

```bash
npm install
npm run dev
```

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –∏ REST API –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã –Ω–∞ http://localhost:3000. –§–∞–π–ª—ã –±—É–¥—É—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è –≤ `./storage`.

–î–ª—è production-—Å–±–æ—Ä–∫–∏:

```bash
npm run build
npm run start
```

---

## –ó–∞–ø—É—Å–∫ –≤ Docker

1. –°–æ–±–µ—Ä–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã:
   ```bash
   docker compose build
   ```

2. –ü–æ–¥–Ω–∏–º–∏—Ç–µ —Å–µ—Ä–≤–∏—Å—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, SQLite –∏ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –∫ –±–∞–∑–µ:
   ```bash
   docker compose up -d
   ```

3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ–º–∞:
   - –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è `storage/` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞ –∫–∞–∫ `/data/reports` –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ `diffpress`;
   - —Ñ–∞–π–ª –±–∞–∑—ã `data/reports.sqlite` —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö `diffpress`, `sqlite` –∏ `sqlite-ui` –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏.

4. UI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ http://localhost:3000 (–ø–æ—Ä—Ç –º–æ–∂–Ω–æ –ø–æ–º–µ–Ω—è—Ç—å —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `PORT`).

5. –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –±–∞–∑—ã SQLite –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ http://localhost:8080. –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è, –±–∞–∑–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `SQLITE_DATABASE`.

---

## REST API

### `POST /api/reports`
–ó–∞–≥—Ä—É–∑–∏—Ç—å PDF –∏ –ø–æ—Å—Ç–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –≤ –æ—á–µ—Ä–µ–¥—å.

- **–ó–∞–ø—Ä–æ—Å:** `multipart/form-data` c –ø–æ–ª–µ–º `file` (PDF).
- **–û—Ç–≤–µ—Ç 202:**
  ```json
  {
    "reportId": "9d1c...",
    "checkId": "6cfb...",
    "status": "queued"
  }
  ```

### `GET /api/reports`
–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –æ—Ç—á—ë—Ç–æ–≤ —Å –ø–æ—Å–ª–µ–¥–Ω–∏–º —Å—Ç–∞—Ç—É—Å–æ–º –ø—Ä–æ–≤–µ—Ä–∫–∏.

- **–û—Ç–≤–µ—Ç 200:**
  ```json
  {
    "reports": [
      {
        "id": "...",
        "originalName": "lab1.pdf",
        "createdAt": "2024-05-01T12:00:00.000Z",
        "priorityIndexedAt": "2024-05-03T08:30:00.000Z",
        "latestCheck": {
          "id": "...",
          "status": "completed",
          "similarity": 74.5,
          "createdAt": "..."
        }
      }
    ]
  }
  ```

### `GET /api/reports/{id}`
–ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ—Ç—á—ë—Ç–µ –∏ –∏—Å—Ç–æ—Ä–∏—è –ø—Ä–æ–≤–µ—Ä–æ–∫.

### `GET /api/checks/{id}`
–°—Ç–∞—Ç—É—Å –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏ —Å–ø–∏—Å–æ–∫ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π.

- –í –ø–æ–ª–µ `matches` –ø—Ä–∏—Ö–æ–¥–∏—Ç –º–∞—Å—Å–∏–≤ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π:
  ```json
  {
    "reportId": "...",
    "reportName": "lab0.pdf",
    "similarity": 64.12,
    "diffPreview": "+ –î–æ–±–∞–≤–ª–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç\n- –£–¥–∞–ª—ë–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç"
  }
  ```
- –í –æ—Ç–≤–µ—Ç–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –ø–æ–ª—è `reportCloudLink`, `reportAddedToCloud` –∏ `reportPriorityIndexedAt`, —á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ –ø–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç—É—Å –æ–±–ª–∞—á–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–æ–π –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏.

### `GET /api/diff?source={reportId}&target={reportId}`
–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ–ª–Ω—ã–π diff –º–µ–∂–¥—É –≤—ã–±—Ä–∞–Ω–Ω—ã–º–∏ –æ—Ç—á—ë—Ç–∞–º–∏ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è UI –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ ¬´–∫–∞–∫ –≤ git diff¬ª).

---

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏ –∞–ª–≥–æ—Ä–∏—Ç–º

1. **–ó–∞–≥—Ä—É–∑–∫–∞** ‚Äî —Ñ–∞–π–ª —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `REPORT_STORAGE_DIR`, –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è —Ç–µ–∫—Å—Ç —Å –ø–æ–º–æ—â—å—é `pdf-parse`.
2. **–ò–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ** ‚Äî —Ç–µ–∫—Å—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª-–∏–Ω–¥–µ–∫—Å –Ω–∞ –¥–∏—Å–∫–µ, –∞ –≤ SQLite –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ, –ø—É—Ç—å –∫ –∏–Ω–¥–µ–∫—Å—É –∏ —Å—Å—ã–ª–∫–∞ –Ω–∞ –æ–±–ª–∞–∫–æ.
3. **–û—á–µ—Ä–µ–¥—å –ø—Ä–æ–≤–µ—Ä–æ–∫** ‚Äî —Å–æ–∑–¥–∞—ë—Ç—Å—è –∑–∞–ø–∏—Å—å –≤ —Ç–∞–±–ª–∏—Ü–µ `checks` —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `queued`, –ø–æ—Å–ª–µ —á–µ–≥–æ —Ñ–æ–Ω–æ–≤–æ–π –≤–æ—Ä–∫–µ—Ä –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ—á–µ—Ä–µ–¥—å.
4. **–ü–æ–¥—Å—á—ë—Ç —Å—Ö–æ–¥—Å—Ç–≤–∞** ‚Äî –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–∞–Ω–µ–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–≥–æ –æ—Ç—á—ë—Ç–∞ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –∫–æ—Å–∏–Ω—É—Å–Ω–æ–µ —Å—Ö–æ–¥—Å—Ç–≤–æ –ø–æ bag-of-words: —Å–Ω–∞—á–∞–ª–∞ –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ —Å –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–º `priority_indexed_at`, –∑–∞—Ç–µ–º –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö.
5. **Diff** ‚Äî –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è —Å—Ç—Ä–æ–∏—Ç—Å—è –∫—Ä–∞—Ç–∫–∏–π –ø—Ä–µ–≤—å—é-–¥–∏—Ñ—Ñ –∏ –ø–æ–ª–Ω—ã–π diff —á–µ—Ä–µ–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫—É `diff`.
6. **UI** ‚Äî —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –æ–ø—Ä–∞—à–∏–≤–∞–µ—Ç API, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç—É—Å, —Å–ø–∏—Å–æ–∫ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π –∏ –≤–∏–∑—É–∞–ª—å–Ω—ã–π diff.

---

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–î–ª—è unit-—Ç–µ—Å—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Vitest. –ü–æ–∫—Ä—ã—Ç–∏–µ –≤–∫–ª—é—á–∞–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫—É –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–∞ –∏ —Ä–∞—Å—á—ë—Ç–∞ –∫–æ—Å–∏–Ω—É—Å–Ω–æ–≥–æ —Å—Ö–æ–¥—Å—Ç–≤–∞.

```bash
npm test
```

–î–æ–±–∞–≤—å—Ç–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–∞—à–∏—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –∏–ª–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤.

---

## –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç diff-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

- –õ–µ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞–π–¥–µ–Ω–Ω—ã–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è —Å –ø—Ä–æ—Ü–µ–Ω—Ç–æ–º –∏ —Ç–µ–∫—Å—Ç–æ–≤—ã–º –ø—Ä–µ–≤—å—é (—Ç–æ–ø-10 —Å—Ç—Ä–æ–∫ diff-–∞).
- –ü—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ ‚Äî –ø–æ–ª–Ω—ã–π diff –≤—ã–±—Ä–∞–Ω–Ω–æ–π –ø–∞—Ä—ã –æ—Ç—á—ë—Ç–æ–≤ —Å –ø–æ–¥—Å–≤–µ—Ç–∫–æ–π –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö (–∑–µ–ª—ë–Ω—ã–µ) –∏ —É–¥–∞–ª—ë–Ω–Ω—ã—Ö (–∫—Ä–∞—Å–Ω—ã–µ) —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤.
- –ü—Ä–∏ –≤—ã–±–æ—Ä–µ –¥—Ä—É–≥–æ–≥–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è UI –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç `/api/diff` –∏ –ø–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã.

---

## –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

- **–•—Ä–∞–Ω–∏–ª–∏—â–µ**: –∑–∞–º–µ–Ω–∏—Ç–µ SQLite –Ω–∞ PostgreSQL ‚Äî –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å –º–æ–¥—É–ª—å `repository.ts`.
- **–û—á–µ—Ä–µ–¥—å**: –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –º–æ–∂–Ω–æ –≤—ã–Ω–µ—Å—Ç–∏ –≤–æ—Ä–∫–µ—Ä –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å –∏ –æ–±—â–∞—Ç—å—Å—è —á–µ—Ä–µ–∑ Redis / RabbitMQ.
- **–ê–ª–≥–æ—Ä–∏—Ç–º**: –º–æ–¥—É–ª—å `text.ts` –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω ‚Äî –º–æ–∂–Ω–æ –ø–æ–¥–º–µ–Ω–∏—Ç—å –∫–æ—Å–∏–Ω—É—Å–Ω–æ–µ —Å—Ö–æ–¥—Å—Ç–≤–æ –Ω–∞ –±–æ–ª–µ–µ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –º–µ—Ç–æ–¥ (n-–≥—Ä–∞–º–º—ã, —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–µ –≤–µ–∫—Ç–æ—Ä—ã –∏ —Ç.–ø.).
- **API-–∫–ª—é—á–∏**: –¥–æ–±–∞–≤—å—Ç–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, API tokens), –µ—Å–ª–∏ –≤ –±—É–¥—É—â–µ–º –ø–æ—è–≤—è—Ç—Å—è —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –ø–æ –∑–∞—â–∏—Ç–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤.

---

## –°–∫—Ä–∏–ø—Ç—ã npm

| –ö–æ–º–∞–Ω–¥–∞          | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                         |
|------------------|------------------------------------|
| `npm run dev`    | dev-—Å–µ—Ä–≤–µ—Ä Next.js                 |
| `npm run build`  | production-—Å–±–æ—Ä–∫–∞                  |
| `npm run start`  | –∑–∞–ø—É—Å–∫ —Å–æ–±—Ä–∞–Ω–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è       |
| `npm run lint`   | ESLint (–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Next.js)      |
| `npm test`       | Vitest unit-—Ç–µ—Å—Ç—ã                  |

---

## –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –≤–Ω–µ—à–Ω–µ–≥–æ –¥–∏—Å–∫–∞

1. –°–æ–∑–¥–∞–π—Ç–µ –∫–∞—Ç–∞–ª–æ–≥ –Ω–∞ –¥–∏—Å–∫–µ, –≥–¥–µ –±—É–¥—É—Ç —Ö—Ä–∞–Ω–∏—Ç—å—Å—è PDF (–Ω–∞–ø—Ä–∏–º–µ—Ä, `/mnt/reports`).
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å Node.js –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∞ –Ω–∞ –∑–∞–ø–∏—Å—å.
3. –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è: `REPORT_STORAGE_DIR=/mnt/reports npm run start`.
4. –ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ Docker –ø–æ–¥–∫–ª—é—á–∏—Ç–µ –¥–∏—Å–∫ –∫–∞–∫ —Ç–æ–º (`- /mnt/reports:/data/reports`).

---

## –õ–∏—Ü–µ–Ω–∑–∏—è

–ü—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω –≤ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —Ü–µ–ª—è—Ö. –ê–¥–∞–ø—Ç–∏—Ä—É–π—Ç–µ –∏ —Ä–∞—Å—à–∏—Ä—è–π—Ç–µ –ø–æ–¥ —Å–≤–æ–∏ –ø—Ä–æ—Ü–µ—Å—Å—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—Ç—á–µ—Ç–æ–≤.
